## 页面置换机制

- [代码][code]

### 页面替换算法

为什么要进行页面替换呢？从前面的学习中我们可以知道：操作系统将物理内存以页帧的形式组织起来，为每一个用户进程单独创建页表，为用户程序将会访问到的虚拟地址映射物理页帧，从而保证用户程序稳定安全地运行。  
但这也带来了一些问题，比如：  
* 用户程序能够使用的虚拟内存空间大小不得超过实际的物理内存大小。
* 某些页帧被映射到用户程序的页表之后，可能极少被访问甚至从不被用户程序访问，导致物理内存资源的浪费。  

页面替换算法希望能够解决的正是上述两类问题。通过合理地进行换出（将物理页帧的内容写入到磁盘）、换入（从磁盘的对应分区读取一个页帧的内容到内存中）；不仅为运行在内核之上的用户程序提供可用规模更大的虚拟内存空间，也能够有效减少物理页帧资源由于用户程序访问频率低导致的浪费。

### “换出”与“换入”

换出页面的时机根据不同的页面替换策略而不同。针对不同的页面替换策略，换出页面的时机不同。大致可以分为积极换出和消极换出。积极换出策略是指系统周期性地（或在系统不忙的时候）将“不常用”的页面换出到磁盘，从而保证系统中一直有空闲页面存在，基本上满足使用需求；消极换出策略是指当分配物理页帧失败时，才开始查找“不常用”页面，将其换出到硬盘。

换入的时机则相对单一，当发生页面访问异常，如果确定是由于页面换出导致的，那么就应该执行换入。